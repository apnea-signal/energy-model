# Apnea Energy Model

This repo packages the annotated AIDA Greece 2025 Dynamic No Fins (DNF) and Dynamic with Bifins (DYNB) races plus the
analytics that feed the static dashboards in `web/`.

## Contents at a glance
- `data/aida_greece_2025/*.csv` – raw competition splits, annotations, and STA references.
- `data/dashboard_data/*.json` – derived payloads regenerated by the numbered scripts.
- `01_*` to `06_*` – processing stages: weighted splits, STA projection bands, DNF movement intensities, movement vs.
  distance bands, oxygen-cost fit, and distance/cost confidence bands.
- `run_all.py` – executes the numbered steps in order (you can pass step prefixes to limit what runs).
- `web/*.html` + `web/js` – static dashboards and calculators that read the CSV/JSON files directly.
- `docs/*.md` – quick data dictionaries for every CSV and an overview of the propulsion model.

## Local setup
```shell
python3 -m venv .venv
source .venv/bin/activate
python -m pip install --upgrade pip
python -m pip install -r requirements.txt
```

## Refresh the derived data
Rebuild every JSON artifact (written into `data/dashboard_data/`) with:
```shell
python run_all.py
```
Each script can also run solo, e.g.:
```shell
python 03_predict_DNF_movement_intensity.py --data-root data/aida_greece_2025 --output data/dashboard_data/03_movement_intensity.json
```

## Dashboards and calculators
Serve the repo root (so the pages can fetch the CSV/JSON files) and open the desired HTML:
```shell
python -m http.server 8000
# http://localhost:8000/web/exploration.html
```
Key pages:
- `web/exploration.html` – unified splits view with STA projections for DNF and DYNB.
- `web/movement_intensity.html` – tables and charts for the first-split propulsion estimates.
- `web/propulsion_fit.html` – visualizes the fitted oxygen budgets from `05_propulsion_fit.json`.
- `web/calculator_dnf.html` / `web/calculator_dynb.html` – quick what-if planners that reuse the split stats.

## Deployment
`.github/workflows/deploy-pages.yml` installs the Python dependencies, re-runs `run_all.py`, copies `web/`, `data/`,
and `docs/`, and publishes everything to GitHub Pages whenever `main` is updated or the workflow is triggered manually.
